
\edef\resetatcatcode{\catcode`\noexpand\@\the\catcode`\@\relax}
\catcode`\@11\relax


\let\pex@normal=\pex
\let\ex@c@normal=\ex@c
\let\pex@e@normal=\pex@e
\let\put@label@normal=\put@label
\let\put@label@b@normal=\put@label@b
\define@choicekey{ling}{altformat}[\ling@altformat\nr]%
   {none,IJAL,tabular}{%
      \ifcase\nr
            \let\pex=\pex@normal
            \let\ex@c=\ex@c@normal
            \let\pex@e=\pex@e@normal
            \let\put@label=\put@label@normal
            \let\put@label@b=\put@label@b@normal
         \or
            \let\pex=\jpex
            \let\ex@c=\ex@c@normal
            \let\pex@e=\pex@e@normal
            \let\put@label=\put@label@normal
            \let\put@label@b=\put@label@b@normal
         \or
            \let\pex\pex@normal
            \let\ex@c=\ex@c@tabular
            \let\pex@e=\pex@e@tabular
            \let\put@label=\put@label@tabular
            \let\put@label@b=\put@label@b@tabular
         \fi
}
%% TABULAR
\def\ex@c@tabular{%
   \ex@setup
   \leftskip=\lingtextoffset
   \par\nobreak
   \leavevmode\llap{\hbox to \leftskip{\if@specialexno
   \specialexnoprint\else\exnoprint\fi\hfil}}%
   \ling@everyex
   \latex@tagex
   \ignorespaces
}
\def\pex@e@tabular{%
   \@pexoffset=\linglabeloffset
   \advance\@pexoffset by \linglabelwidth
   \advance\@pexoffset by \lingtextoffset
   \pexcnt@init
   \ling@everyex
   \latex@tagex
   \ignorespaces
   \@firstlabeltrue
   \let\a\put@label
   \leftskip=\lingtextoffset
   \leavevmode
   \llap{\hbox to \leftskip{\if@specialexno
      \specialexnoprint\else\exnoprint\fi\hfil}}%
   \ling@everyex
}
\def\put@label@tabular{%
   \if@firstlabel
      \ifling@nopreamble \else
         \vskip\ling@belowpreambleskip \fi
      \@firstlabelfalse
   \else
      \par\penalty\ling@splitpartspenalty
      \vskip\ling@interpartskip
   \fi
   \def\@specialexno{}\def\@optionaltag{}%
   \@getoptionalarg\put@label@a
}
\def\put@label@b@tabular{%
   \ifx\@optionaltag\empty \else
      \deftaglabel{\@optionaltag}%
      \fi
   \leavevmode
   \llap{\hbox to \lingtextoffset{\hskip\linglabeloffset
      \labelformat\ep@label \hfil}}%
   \latex@tagexlabel
   \ignorespaces
}
%% IJAL
\def\jpex{\bgroup
   \let\pex@d=\jpex@d
   \let\pex@e=\jpex@e
   \let\xe=\jxe
   \let\put@label=\put@jpexlabel
   \lingset{labelformat=(A)}
   \@tildecheck
   \pex@a
}
\def\jpex@d{%
   \ifx\temp\a \let\nextpex@\pex@e
      \else \ifx\temp\label \let\nextpex@\pex@f
      \else \ling@nopreamblefalse \let\nextpex@\pex@e
      \fi\fi
   \ex@setup
   \nextpex@
}
\def\jpex@e{%
   \pexcnt@init
   \@firstlabeltrue
   \let\a\put@label
   \setbox0=\hbox{\exnoprint a}%
   \leftskip=\lingnumoffset
   \advance\leftskip by \wd0
   \advance\leftskip by \lingtextoffset
   \ifling@nopreamble
      \let\specialexnoprint=\relax
      \let\exnoprint=\relax
      \fi
   \leavevmode
   \llap{\hbox to \leftskip{%
      \hskip\lingnumoffset
      \if@specialexno \specialexnoprint\else\exnoprint\fi
      \hfil}}%
   \ling@everyex
}
\def\jxe{%
   \strut
   \expandafter\vskip\lingbelowexskip
   \egroup
   \allowbreak
   \noindent
}
\def\put@jpexlabel{%
   \if@firstlabel
      \ifling@nopreamble
         \else
         \vskip\ling@belowpreambleskip
         \fi
      \@firstlabelfalse
   \else
      \par\penalty\ling@splitpartspenalty
      \vskip\ling@interpartskip
   \fi
   \def\@specialexno{}\def\@optionaltag{}%
   \@getoptionalarg\put@jpexlabel@a
}
\def\put@jpexlabel@a{%
   \useoptionallabelarg
   \def\ep@label{
      \if@specialexno \ling@specialexno\else
         \the\excnt\fi \the\ep@everylabel\char\the\pexcnt}%
   \advance\pexcnt by 1
   \@getoptionaltag
   \put@jpexlabel@b
}
\def\put@jpexlabel@b{%
   \ifx\@optionaltag\empty \else
      \deftaglabel{\@optionaltag}%
      \fi
   \leavevmode
   \llap{\hbox to \leftskip{\hskip\lingnumoffset
      \@labelprint\hss}}%
   \latex@tagexlabel
   \ignorespaces
}


\resetatcatcode

